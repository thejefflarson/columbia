<html>
  <head>
    <link rel="stylesheet" href="../stylesheets/reset.css">
    <link rel="stylesheet" href="../stylesheets/tachyons.min.css">
    <link rel="stylesheet" href="../stylesheets/tweaks.css">
    <script src="../javascripts/d3.js"></script>
    <script src="../javascripts/topojson.min.js"></script>
    <script src="raster-map.js"></script>
    <style>
      #durango path {
        fill: none;
        stroke: #00449E;
        stroke-linejoin: round;
        stroke-width: 1px;
      }
    </style>
  </head>
  <body>
    <pre>
function gdal_extent() {
    if [ -z "$1" ]; then
        echo "Missing arguments. Syntax:"
        echo "  gdal_extent <input_raster>"
        return
    fi
    EXTENT=$(gdalinfo $1 |\
        grep "Upper Left\|Lower Right" |\
        sed "s/Upper Left  //g;s/Lower Right //g;s/).*//g" |\
        tr "\n" " " |\
        sed 's/ *$//g' |\
        tr -d "[(,]")
    echo -n "$EXTENT"
}

ogr2ogr durango.json tl_2016_08067_roads.shp -f GeoJSON -simplify 0.01 \
  -clipdst $(gdal_extent durango.tif) \
  -sql "select * from tl_2016_08067_roads where FULLNAME is not NULL"

function ogr_extent() {
    if [ -z "$1" ]; then
        echo "Missing arguments. Syntax:"
        echo "  ogr_extent <input_vector>"
        return
    fi
    EXTENT=$(ogrinfo -al -so $1 |\
        grep Extent |\
        sed 's/Extent: //g' |\
        sed 's/(//g' |\
        sed 's/)//g' |\
        sed 's/ - /, /g')
    EXTENT=`echo $EXTENT | awk -F ',' '{print $1 " " $4 " " $3 " " $2}'`
    echo -n "$EXTENT"
}

gdal_translate shaded.tif durango-clipped.tif -projwin $(ogr_extent durango.json)
gdalwarp durango-clipped.tif durango-large.tif -t_srs EPSG:3857 -r lanczos
gdalwarp durango-large.tif durango-smaller.tif -ts 401 623 -r lanczos
gdal_translate durango-smaller.tif durango.png -of PNG
    </pre>


    <svg id="durango"></svg>
  </body>
</html>
